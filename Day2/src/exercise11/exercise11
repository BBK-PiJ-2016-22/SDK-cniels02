See exercise 9 for implementation.